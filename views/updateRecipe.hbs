{{! header }}
{{> _header}}

{{! main }}
<main>
  {{! Page title section }}
  <div
    class="flex flex-col items-center justify-around"
    style=" background-image: url(/images/background.jpg); background-repeat: no-repeat; background-size:cover; min-height: 40vh; background-position:right top ;"
  >

    <h1
      class="text-5xl font-bold uppercase text-gray-100 pb-3 pt-20"
      style="letter-spacing:0.9rem;color: #F0EBCE"
    >Edit Recipe</h1>

    <h2
      class="pb-10 text-center text-lg w-4/5 text-gray-200 lg:text-xl sm:px-16 lg:px-48 dark:text-gray-400 mx-auto"
    >
      Fill in the fields below to edit this family recipe.
    </h2>

  </div>

  {{! if no success, show alert with error }}
  {{#if errors}}
    <div
      class="w-3/5 mx-auto mt-5 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative"
      role="alert"
    >
      <strong class="font-bold">Oops! This recipe could not be edited. Try again
        later</strong>
    </div>

    <div class="w-3/5 mx-auto text-red-700 text-sm py-3 rounded relative">
      <ul class="list-disc pl-5">
        {{#each errors}}
          <li>{{this.msg}}</li>
        {{/each}}
      </ul>

    </div>
  {{/if}}

  {{! form }}
  <div class="flex justify-center w-4/5 mx-auto my-10">

    <form
      action="/recipe/update/{{recipe._id}}"
      method="post"
      enctype="multipart/form-data"
      class="flex flex-col w-full"
    >
      {{! this is a hidden input field that will be sent to the server as a PUT request }}
      <input type="hidden" name="_method" value="PUT" />

      <div class="flex">
        {{! left side }}
        <div class="p-y-3 w-2/5 mr-10">

          <div class="mb-5">
            <label
              for="title"
              class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Title</label>
            <input
              required
              type="text"
              name="title"
              id="title"
              class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
              value="{{recipe.title}}"
            />
          </div>

          <div class="mb-5">
            <label
              for="author"
              class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Author</label>
            <input
              required
              type="text"
              name="author"
              id="author"
              class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
              value="{{recipe.author.name}}"
            />
          </div>

          <div class="mb-5">
            <label
              for="email"
              class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Email</label>
            <input
              required
              type="email"
              name="email"
              id="email"
              class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
              value="{{recipe.author.email}}"
            />
          </div>

          <div class="mb-5">
            <label
              for="category"
              class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Category</label>

            <select
              required
              name="category"
              id="category"
              class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
            >
              <option value=""></option>
              {{#each categories}}
                <option value="{{this.name}}">{{this.name}}</option>
              {{/each}}

            </select>
            <p>orginal value - {{recipe.category}}</p>
          </div>

          <div class="mb-5">
            <label
              for="time"
              class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Required time (min.)</label>
            <input
              required
              type="number"
              name="time"
              id="time"
              class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
              value="{{recipe.prepTimeInMinutes}}"
            />
          </div>

          <div class="mb-5">
            <label
              for="difficulty"
              class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Difficulty</label>
            <select
              required
              name="difficulty"
              id="difficulty"
              class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
            >
              <option value=""></option>
              <option value="easy">Easy</option>
              <option value="easy">Medium</option>
              <option value="easy">Hard</option>
            </select>
            <p>orginal value - {{recipe.difficulty}}</p>
          </div>

          <div class="mb-5">
            <label
              for="servings"
              class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >How many servings does this recipe yield?</label>
            <input
              required
              type="number"
              name="servings"
              id="servings"
              class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
              value="{{recipe.servings}}"
            />
          </div>

          <div class="mb-5">
            <label
              for="recipe-img"
              class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Image</label>
            <img src="{{recipe.picture_url}}" alt="" />
            <input type="file" src="" alt="" name="recipe-img" />
          </div>

          <button
            type="submit"
            class="w-full mr-10 text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg px-5 py-3 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800"
          >
            Submit
          </button>

        </div>

        {{! right side }}
        <div class="p-y-3 w-3/5 ml-10">
          <div class="mb-5">
            <label
              for="summary"
              class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Summary</label>
            <textarea
              name="summary"
              id="summary"
              cols="30"
              rows="5"
              class="px-0 w-full text-sm text-gray-900 border-0 focus:ring-0 focus:outline-none py-2 px-4 bg-gray-50 rounded-lg rounded-t-lg border border-gray-300 dark:bg-gray-800 dark:border-gray-700"
              required
            >{{recipe.summary}}</textarea>
          </div>

          <div id="ingredients-list" class="mb-5">
            <label
              for="ingredients[]"
              class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Ingredients</label>

            {{#each recipe.ingredients}}
              <div class="flex">
                <input
                  type="text"
                  name="ingredients[]"
                  placeholder="Ingredient"
                  class="mb-2 mr-3 bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                  value="{{this.name}}"
                />
                <input
                  type="text"
                  name="amounts[]"
                  placeholder="Amount"
                  class="mb-2 bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                  value="{{this.quantity}}"
                />
              </div>
            {{/each}}
          </div>

          <button
            id="add-ingredient"
            type="button"
            class="px-5 py-2.5 mb-5 align-center text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700"
          >
            Add Ingredient
          </button>

          <div class="mb-5">
            <label
              for="instructions"
              class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Instructions</label>
            <textarea
              name="instructions"
              id="instructions"
              cols="30"
              rows="5"
              class="px-0 w-full text-sm text-gray-900 border-0 focus:ring-0 focus:outline-none py-2 px-4 mb-4 bg-gray-50 rounded-lg rounded-t-lg border border-gray-300 dark:bg-gray-800 dark:border-gray-700"
              required
            >{{recipe.instructions}}</textarea>
          </div>
        </div>

      </div>

    </form>

  </div>
</main>

{{! scripts }}
<script>

  document.getElementById('add-ingredient').addEventListener('click', function()
  { var newIngredientGroup = document.createElement('div');
  newIngredientGroup.className = 'flex'; var newIngredientInput =
  document.createElement('input'); newIngredientInput.type = 'text';
  newIngredientInput.name = 'ingredients[]'; newIngredientInput.placeholder =
  'Ingredient'; newIngredientInput.className = 'mb-2 mr-3 bg-gray-50 border
  border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600
  focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700
  dark:border-gray-600 dark:placeholder-gray-400 dark:text-white
  dark:focus:ring-blue-500 dark:focus:border-blue-500';
  newIngredientGroup.appendChild(newIngredientInput); var newAmountInput =
  document.createElement('input'); newAmountInput.type = 'text';
  newAmountInput.name = 'amounts[]'; newAmountInput.placeholder = 'Amount';
  newAmountInput.className = 'mb-2 bg-gray-50 border border-gray-300
  text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600
  focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700
  dark:border-gray-600 dark:placeholder-gray-400 dark:text-white
  dark:focus:ring-blue-500 dark:focus:border-blue-500';
  newIngredientGroup.appendChild(newAmountInput);
  document.getElementById('ingredients-list').appendChild(newIngredientGroup);
  });

</script>